{"version":3,"sources":["App.js","index.js"],"names":["App","props","_this","Object","classCallCheck","this","possibleConstructorReturn","getPrototypeOf","call","generateCoordinates","x","y","Math","random","toFixed","setRef","webcam","capture","imageSrc","getScreenshot","axios","post","frame","model_id","state","uuid","coord_x","coordinates","coord_y","then","response","status","setState","oldState","sentImages","amountOfSamples","enableProduction","stage","message","poll","index","imageIndex","data","imageUrl","image_url","setTimeout","initialized","undefined","_this2","get","result","n_samples","react_default","a","createElement","className","react_webcam_default","audio","height","ref","screenshotFormat","width","videoConstraints","facingMode","style","top","left","onClick","react","src","React","Component","ReactDOM","render","src_App_0","document","getElementById"],"mappings":"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","file":"static/js/main.cc618b1c.chunk.js","sourcesContent":["import React, {Fragment} from 'react';\nimport Webcam from 'react-webcam';\nimport axios from 'axios';\nimport './App.css';\n\nclass App extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      initialized: false,\n      coordinates: this.generateCoordinates(),\n      sentImages: 0,\n      amountOfSamples: 0,\n      uuid: undefined,\n      stage: 'training',\n      imageIndex: 0,\n      imageUrl: '',\n      message: 'Look at the circle and click on it'\n    };\n  }\n\n  componentDidMount() {\n    axios.get('/new')\n      .then(result => {\n        if (result.status === 200) {\n          this.setState({\n            initialized: true,\n            uuid: result.data.model_id,\n            amountOfSamples: result.data.n_samples\n          })\n        }\n      });\n  }\n\n  generateCoordinates = (x, y) => {\n    return {\n      x: typeof(x) === 'number' ? x : (Math.random() * 1280).toFixed(),\n      y: typeof(y) === 'number'  ? y : (Math.random() * 720).toFixed()\n    };\n  };\n\n  setRef = webcam => {\n    this.webcam = webcam;\n  };\n\n  capture = () => {\n    const imageSrc = this.webcam.getScreenshot();\n    axios.post('/train', {\n      frame: imageSrc,\n      model_id: this.state.uuid,\n      coord_x: this.state.coordinates.x,\n      coord_y: this.state.coordinates.y\n    })\n      .then(response => {\n        if (response.status === 200) {\n          this.setState(oldState => {\n            const sentImages = oldState.sentImages + 1;\n            if (sentImages === oldState.amountOfSamples) this.enableProduction();\n            return {\n              sentImages,\n              coordinates: this.generateCoordinates()\n            };\n          });\n        }\n      });\n  };\n\n  enableProduction = () => {\n    this.setState({\n      stage: 'production',\n      message: 'Model trained. Just look at the image!'\n    });\n    this.poll();\n  };\n\n  poll = () => {\n    const imageSrc = this.webcam.getScreenshot();\n    axios.post('/analyze', {\n      frame: imageSrc,\n      model_id: this.state.uuid,\n      index: this.state.imageIndex\n    })\n      .then(response => {\n        if (response.status === 200) {\n          this.setState({\n            coordinates: this.generateCoordinates(response.data.coord_x, response.data.coord_y),\n            imageIndex: response.data.index,\n            imageUrl: response.data.image_url\n          });\n          setTimeout(() => this.poll(), 1000);\n        }\n      })\n  };\n\n  render() {\n    const videoConstraints = {\n      width: 1280,\n      height: 720,\n      facingMode: \"user\"\n    };\n\n    return (\n      <div>\n        <h3>{this.state.message}</h3>\n        <div className=\"container\">\n          <div className=\"webcam\">\n            <Webcam\n              audio={false}\n              height={720}\n              ref={this.setRef}\n              screenshotFormat=\"image/jpeg\"\n              width={1280}\n              videoConstraints={videoConstraints}\n            />\n          </div>\n          <div className=\"canvas\">\n          </div>\n          {this.state.initialized && this.state.stage === 'training' ? (\n            <button\n              className=\"point\"\n              style={{\n                top: this.state.coordinates.y + 'px',\n                left: this.state.coordinates.x + 'px'\n              }}\n              onClick={this.capture}\n            />\n          ) : (\n            <Fragment>\n              <img className=\"image\" src={this.state.imageUrl}/>\n              <span\n                className=\"plus\"\n                style={{\n                  top: this.state.coordinates.y + 'px',\n                  left: this.state.coordinates.x + 'px'\n                }}\n              >+</span>\n            </Fragment>\n          )}\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n\nReactDOM.render(<App />, document.getElementById('root'));\n"],"sourceRoot":""}