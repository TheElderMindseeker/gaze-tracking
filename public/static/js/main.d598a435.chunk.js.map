{"version":3,"sources":["App.js","index.js"],"names":["App","props","_this","Object","classCallCheck","this","possibleConstructorReturn","getPrototypeOf","call","generateCoordinates","x","y","Math","random","toFixed","setRef","webcam","capture","imageSrc","getScreenshot","axios","post","frame","model_id","state","uuid","coord_x","coordinates","coord_y","then","response","status","setState","oldState","sentImages","amountOfSamples","enableProduction","stage","poll","index","imageIndex","data","imageUrl","image_url","setTimeout","initialized","undefined","_this2","get","result","n_samples","react_default","a","createElement","className","react_webcam_default","audio","height","ref","screenshotFormat","width","videoConstraints","facingMode","style","top","left","onClick","react","src","React","Component","ReactDOM","render","src_App_0","document","getElementById"],"mappings":"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","file":"static/js/main.d598a435.chunk.js","sourcesContent":["import React, {Fragment} from 'react';\nimport Webcam from 'react-webcam';\nimport axios from 'axios';\nimport './App.css';\n\nclass App extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      initialized: false,\n      coordinates: this.generateCoordinates(),\n      sentImages: 0,\n      amountOfSamples: 0,\n      uuid: undefined,\n      stage: 'training',\n      imageIndex: 0,\n      imageUrl: ''\n    };\n  }\n\n  componentDidMount() {\n    axios.get('/new')\n      .then(result => {\n        if (result.status === 200) {\n          this.setState({\n            initialized: true,\n            uuid: result.data.model_id,\n            amountOfSamples: result.data.n_samples\n          })\n        }\n      });\n  }\n\n  generateCoordinates = (x, y) => {\n    return {\n      x: typeof(x) === 'number' ? x : (Math.random() * 1280).toFixed(),\n      y: typeof(y) === 'number'  ? y : (Math.random() * 720).toFixed()\n    };\n  };\n\n  setRef = webcam => {\n    this.webcam = webcam;\n  };\n\n  capture = () => {\n    const imageSrc = this.webcam.getScreenshot();\n    axios.post('/train', {\n      frame: imageSrc,\n      model_id: this.state.uuid,\n      coord_x: this.state.coordinates.x,\n      coord_y: this.state.coordinates.y\n    })\n      .then(response => {\n        if (response.status === 200) {\n          this.setState(oldState => {\n            const sentImages = oldState.sentImages + 1;\n            if (sentImages === oldState.amountOfSamples) this.enableProduction();\n            return {\n              sentImages,\n              coordinates: this.generateCoordinates()\n            };\n          });\n        }\n      });\n  };\n\n  enableProduction = () => {\n    this.setState({stage: 'production'});\n    this.poll();\n  };\n\n  poll = () => {\n    const imageSrc = this.webcam.getScreenshot();\n    axios.post('/analyze', {\n      frame: imageSrc,\n      model_id: this.state.uuid,\n      index: this.state.imageIndex\n    })\n      .then(response => {\n        if (response.status === 200) {\n          this.setState({\n            coordinates: this.generateCoordinates(response.data.coord_x, response.data.coord_y),\n            imageIndex: response.data.index,\n            imageUrl: response.data.image_url\n          });\n          setTimeout(() => this.poll(), 1000);\n        }\n      })\n  };\n\n  render() {\n    const videoConstraints = {\n      width: 1280,\n      height: 720,\n      facingMode: \"user\"\n    };\n\n    return (\n      <div>\n        <h3>Text</h3>\n        <div className=\"container\">\n          <div className=\"webcam\">\n            <Webcam\n              audio={false}\n              height={720}\n              ref={this.setRef}\n              screenshotFormat=\"image/jpeg\"\n              width={1280}\n              videoConstraints={videoConstraints}\n            />\n          </div>\n          <div className=\"canvas\">\n          </div>\n          {this.state.initialized && this.state.stage === 'training' ? (\n            <button\n              className=\"point\"\n              style={{\n                top: this.state.coordinates.y + 'px',\n                left: this.state.coordinates.x + 'px'\n              }}\n              onClick={this.capture}\n            />\n          ) : (\n            <Fragment>\n              <img className=\"image\" src={this.state.imageUrl}/>\n              <span\n                className=\"plus\"\n                style={{\n                  top: this.state.coordinates.y + 'px',\n                  left: this.state.coordinates.x + 'px'\n                }}\n              >+</span>\n            </Fragment>\n          )}\n          <button onClick={this.capture}>Capture photo</button>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n\nReactDOM.render(<App />, document.getElementById('root'));\n"],"sourceRoot":""}